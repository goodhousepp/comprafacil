<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>CompraFÃ¡cil</title>

<style>
:root{
  --bg1:#0d1b2a;
  --bg2:#16283f;
  --card:#1b3350;
  --text:#ffffff;
  --muted:#cbd5e1;
  --primary:#2563eb;
  --danger:#ef4444;
  --ok:#22c55e;
  --radius:14px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  color:var(--text);
  overflow-x:hidden;
}

.wrap{
  max-width:720px;
  margin:auto;
  padding:16px;
  padding-bottom:220px;
}

h1{
  margin:0 0 12px;
  font-size:22px;
}

button, input, select{
  font-size:16px;
  border-radius:var(--radius);
  padding:12px;
  border:none;
  width:100%;
}

input, select{
  background:rgba(255,255,255,.08);
  color:white;
}

button{
  cursor:pointer;
}

.addBtn{
  background:var(--primary);
  color:white;
  font-weight:bold;
}

.filters{
  display:flex;
  gap:8px;
  margin-bottom:12px;
}

.filters button{
  flex:1;
  background:rgba(255,255,255,.08);
  color:white;
}

.filters .active{
  background:var(--primary);
}

.list{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:12px;
}

.item{
  background:var(--card);
  padding:12px;
  border-radius:var(--radius);
  display:flex;
  align-items:center;
  gap:10px;
}

.item input[type=checkbox]{
  width:22px;
  height:22px;
}

.name{
  flex:1;
  font-size:17px;
  word-break:break-word;
}

.done .name{
  text-decoration:line-through;
  opacity:.6;
}

.tag{
  font-size:12px;
  background:rgba(37,99,235,.3);
  padding:4px 8px;
  border-radius:10px;
}

.qtyBtn{
  background:rgba(37,99,235,.2);
  color:white;
}

.delBtn{
  background:rgba(239,68,68,.3);
  color:white;
}

/* BARRA INFERIOR 100% RESPONSIVA */
.bottomBar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:rgba(19,37,58,.95);
  padding:14px;
}

/* Layout corrigido para mobile */
.gridInput{
  display:grid;
  grid-template-columns:1fr 80px;
  gap:10px;
}

.gridInput select{
  grid-column:1 / -1;
}

.gridInput .addBtn{
  grid-column:1 / -1;
  margin-top:6px;
}

.actions{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:10px;
}

.actions button{
  flex:1;
  background:rgba(255,255,255,.08);
  color:white;
  font-size:14px;
}

.actions .danger{
  background:rgba(239,68,68,.3);
}
</style>
</head>

<body>

<div class="wrap">
<h1>ðŸ›’ CompraFÃ¡cil</h1>

<div class="filters">
<button id="fAll" class="active">Todos</button>
<button id="fTodo">Pendentes</button>
<button id="fDone">Comprados</button>
</div>

<select id="filterCategory">
<option value="all">Todas categorias</option>
<option>Hortifruti</option>
<option>Padaria/Matinais</option>
<option>Carnes</option>
<option>LaticÃ­nios</option>
<option>Mercearia</option>
<option>Bebidas</option>
<option>Limpeza</option>
<option>Higiene</option>
<option>Outros</option>
</select>

<div class="list" id="list"></div>
</div>

<div class="bottomBar">
<div class="gridInput">
<input id="product" placeholder="Produto (ex: leite)">
<input id="qty" placeholder="Qtd">
<select id="category">
<option>Hortifruti</option>
<option>Padaria/Matinais</option>
<option>Carnes</option>
<option>LaticÃ­nios</option>
<option>Mercearia</option>
<option>Bebidas</option>
<option>Limpeza</option>
<option>Higiene</option>
<option>Outros</option>
</select>
<button class="addBtn" id="addBtn">Adicionar</button>
</div>

<div class="actions">
<button id="clearDone">Remover comprados</button>
<button id="sortAZ">Ordenar Aâ€“Z</button>
<button id="sortStore">Ordem de inclusÃ£o</button>
<button id="clearAll" class="danger">Limpar tudo</button>
</div>
</div>

<script>
const STORAGE="comprafacil_v4";
let items=JSON.parse(localStorage.getItem(STORAGE))||[];
let filter="all";
let order="store";
let catFilter="all";

function save(){localStorage.setItem(STORAGE,JSON.stringify(items));}

function render(){
let view=[...items];

if(filter==="todo") view=view.filter(i=>!i.done);
if(filter==="done") view=view.filter(i=>i.done);
if(catFilter!=="all") view=view.filter(i=>i.category===catFilter);

if(order==="az"){
view.sort((a,b)=>a.name.localeCompare(b.name,"pt-BR",{sensitivity:"base"}));
}else{
view.sort((a,b)=>b.createdAt-a.createdAt);
}

const list=document.getElementById("list");
list.innerHTML="";

view.forEach(item=>{
const row=document.createElement("div");
row.className="item"+(item.done?" done":"");

const check=document.createElement("input");
check.type="checkbox";
check.checked=item.done;
check.onchange=()=>{
item.done=check.checked;
save();
render();
};

const name=document.createElement("div");
name.className="name";
name.textContent=item.name;

const tag=document.createElement("div");
tag.className="tag";
tag.textContent=item.category;

const qty=document.createElement("button");
qty.className="qtyBtn";
qty.textContent=item.qty;
qty.onclick=()=>{
const val=prompt("Quantidade:",item.qty);
if(val!==null){
item.qty=val||"1";
save();
render();
}
};

const del=document.createElement("button");
del.className="delBtn";
del.textContent="X";
del.onclick=()=>{
items=items.filter(i=>i!==item);
save();
render();
};

row.append(check,name,tag,qty,del);
list.appendChild(row);
});
}

document.getElementById("addBtn").onclick=()=>{
const name=document.getElementById("product").value.trim();
const qty=document.getElementById("qty").value.trim()||"1";
const category=document.getElementById("category").value;
if(!name)return;

items.unshift({
name,qty,category,done:false,createdAt:Date.now()
});
save();
render();
document.getElementById("product").value="";
document.getElementById("qty").value="";
};

document.getElementById("fAll").onclick=()=>{
filter="all";
setActive("fAll");
render();
};
document.getElementById("fTodo").onclick=()=>{
filter="todo";
setActive("fTodo");
render();
};
document.getElementById("fDone").onclick=()=>{
filter="done";
setActive("fDone");
render();
};

function setActive(id){
document.querySelectorAll(".filters button")
.forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

document.getElementById("filterCategory").onchange=e=>{
catFilter=e.target.value;
render();
};

document.getElementById("clearDone").onclick=()=>{
items=items.filter(i=>!i.done);
save();
render();
};

document.getElementById("clearAll").onclick=()=>{
if(confirm("Apagar tudo?")){
items=[];
save();
render();
}
};

document.getElementById("sortAZ").onclick=()=>{
order="az";
render();
};

document.getElementById("sortStore").onclick=()=>{
order="store";
render();
};

render();
</script>

</body>
</html>
